<div class="space-y-3">
    <!-- Stage Selection -->
    <div class="grid grid-cols-2 gap-2">
        <div>
            <label class="block text-xs font-medium text-gray-600 mb-1">Stage</label>
            <select id="log-stage" name="stage"
                    hx-get="/partials/workspaces/{{ workspace.id }}/logs-controls"
                    hx-target="#logs-controls"
                    hx-swap="innerHTML"
                    hx-include="#log-stage"
                    class="w-full px-3 py-2 border border-gray-300 rounded-md text-sm">
                <option value="prepare" {% if stage == 'prepare' %}selected{% endif %}>Prepare</option>
                <option value="test" {% if stage == 'test' %}selected{% endif %}>Test</option>
                <option value="run" {% if stage == 'run' %}selected{% endif %}>Run</option>
            </select>
        </div>

        {% if stage == 'run' and servers %}
        <!-- Server Selection (only for run stage with multi-server deployment) -->
        <div>
            <label class="block text-xs font-medium text-gray-600 mb-1">Server</label>
            <select id="log-server" name="server" class="w-full px-3 py-2 border border-gray-300 rounded-md text-sm">
                {% for srv in servers %}
                <option value="{{ srv }}">{{ srv }}</option>
                {% endfor %}
            </select>
        </div>
        {% else %}
        <div>
            <label class="block text-xs font-medium text-gray-600 mb-1">Step</label>
            <input type="number" id="log-step" name="step" value="0" min="0"
                   class="w-full px-3 py-2 border border-gray-300 rounded-md text-sm">
        </div>
        {% endif %}
    </div>

    {% if stage == 'run' and servers %}
    <!-- Step selection for run stage (separate row) -->
    <div class="grid grid-cols-2 gap-2">
        <div>
            <label class="block text-xs font-medium text-gray-600 mb-1">Step</label>
            <input type="number" id="log-step" name="step" value="0" min="0"
                   class="w-full px-3 py-2 border border-gray-300 rounded-md text-sm">
        </div>
        <div>
            <label class="block text-xs font-medium text-gray-600 mb-1">Replica</label>
            <input type="number" id="log-replica" name="replica" value="0" min="0"
                   class="w-full px-3 py-2 border border-gray-300 rounded-md text-sm">
        </div>
    </div>
    {% endif %}

    <!-- Fetch Button -->
    <button 
        hx-get="/partials/workspaces/{{ workspace.id }}/logs"
        hx-target="#logs-output"
        hx-swap="innerHTML"
        hx-include="#log-stage, #log-step, #log-server, #log-replica"
        class="w-full bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-md text-sm font-medium transition">
        Fetch Logs
    </button>

    {% if stage == 'run' and not servers %}
    <p class="text-xs text-yellow-600">
        ⚠️ No servers found. Deploy a landscape profile first.
    </p>
    {% endif %}
</div>
